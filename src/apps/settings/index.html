<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wifi Manager</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/vendor/modernizr.js"></script>

  </head>
  <body>
    
    <header class="grey"> <!-- Class can be "blue", "red", "grey", "orange" -->
      <section>
        <div class="app-title-container">
          <h2>Tool Settings</h2>
        </div>
      </section>
    </header>

    <section class="container">
      <div class="row title" style="padding-bottom: 0.375rem;">
         <div class="small-9 medium-10 columns">
           <dl class="tabs" data-tab>
            <dd><a href="#panel2">Dashboard</a></dd>
            <dd><a href="#panel3">Engine</a></dd>
            <dd class="active"><a href="#panel4">Drivers</a></dd>
          </dl>
         </div>
        <div class="small-3 medium-2 columns">
          <div class="[tiny small large] button right radius" id="refresh">Refresh</div>
        </div>
      </div>

      <div class="row" id="refresh-section" style="display:none;">
        <div class="small-12 columns center">
          <span style="text-align:center;">
            <svg class="spinner" width="40px" height="40px" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
              <circle class="path" fill="none" stroke-width="4" stroke-linecap="round" cx="20" cy="20" r="16"></circle>
            </svg>
            <h4 style="display:inline;"> Scanning ... </h4>
          </span>
        </div>
      </div>

      <div class="tabs-content">

        <div class="content" id="panel2">
          <div class="row" id="dashboard">
            <div class="small-12 medium-6 columns list1">
               <table>
                <thead><tr><th width="150">Parameter</th><th width="150">Value</th></tr></thead>
                <tbody id="engine_list"></tbody>
              </table>
            </div>
            <div class="small-12 medium-6 columns list2">
               <table>
                <thead><tr><th width="150">Parameter</th><th width="150">Value</th></tr></thead>
                <tbody id="engine_list"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="content" id="panel3">

        </div>

        <div class="content active" id="panel4">
          <div class="row" id="Engine">
            <div class="small-12 columns">
              <table>
                <thead><tr><th width="220">Parameter</th><th width="250">Value</th></tr></thead>
                <tbody id="engine_list"></tbody>
              </table>
            </div>
          </div>
        </div>

      </div>

    </section>
    
    <div id="passwdModal" class="reveal-modal" data-reveal>
      <div class="row title">
        <div class="small-12 columns">
          <h3>Network password :</h3>
        </div>
      </div>
      <div class="row">
      <div class="small-12 columns">
        <div class="row collapse">
          <div class="small-10 columns">
            <input type="password" id="netwk_passwd" required placeholder="Password">
          </div>
          <div class="small-2 columns">
            <a href="#" id="netwk_send" class="button postfix">Send</a>
          </div>
        </div>
      </div>
      </div>
    </div>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/FabMo.wifi_manager.js"></script>
    <script src="js/FabMo-0.6.2.js"></script>
    <script src="js/foundation.min.js"></script>

    <script>
      var machine = dashboard.machine;

      //Load the settings of the machine
      function loadDriverSettings (machine){
        $("#engine_list").empty();

        if(machine==null) {
          dashboard.notification("error","No machine selected")
        }
        else {
          machine.get_config(function(err,config){
            if(err){console.log(err);return;}

            for(var propt in config.engine){
               var html = [
                '<tr><td>',
                  propt,
                '</td><td>',
                  '<input type="text" id="' + propt +'-label" value="' + config.engine[propt] + '">',
                '</td></tr>'
                ].join('');
                $("#engine_list").append(html);
            }
          });
        }
      };

      $(document).ready(function(){
          $(document).foundation();
          loadDriverSettings(machine);
          $("#refresh").click(function(){ 
            machine=dashboard.machine;
            loadDriverSettings(machine);
          });
          console.log("Key Value :" + sessionStorage.getItem('key'));
      });
      
    </script>
  </body>
</html>